第1回レポート課題

以下の課題 I，II, III についてレポートを作成し提出せよ．
［課題 I］

次のリンクから参照できる sh-script(643) を sample という名前に保存し，次の作業を行いなさい.

1）sample を実行パス(シェル変数 path で設定されている．環境変数 PATH でも同じ) のあるディレクトリ(例えば ~/bin など)に移動せよ.

※ ディレクトリbinはホームディレクトリの下に自分で作ること．

2）そのディレクトリ下で

% chmod u+x sample
% rehash

を実行せよ．

3）ホームディレクトリに移動し，

% sample .emacs .cshrc .xsession .alias

を実行してみよ.

4）実行結果として，result.html というファイルが作成されるはずである． result.html を firefox で開き，その内容を確認するとともに，ソースコードも参照せよ．firefox では，「File」メニューから「Open File...」ボタンを押し，そこから目的のファイルを選択することで，ローカルのディレクトリに存在するファイルを開くことができる．ファイル選択後は，「Open」ボタンを押せばよい．また，ソースの参照は，「View」メニューから，「Page Source」を選択すればよい．

5）以上の作業を通して，以下の内容をレポートにまとめよ．

    上記作業のうち，1），2）の作業がもつ意味．
    このシェルスクリプトのコマンドとしての動作説明．
    シェルスクリプトの各行の動作内容の説明．ただし，最終的に全ての行の役割が説明中に含まれていればよいので，複数行をまとめて説明しても構わない．

尚，スクリプト中の各コマンドの説明は，man sh を調べよ． HTMLのタグに関しては，以下に補足する．

<HTML> ... </HTML>
    <HTML> と </HTML> で囲まれた内容が HTML文書である事を示す．

<HEAD> ... </HEAD>
    <HEAD> と </HEAD> で囲まれた内容が HTML文書の本文ではなく，ヘッダ（頭書き）である事を示す．

<TITLE> ... </TITLE>
    <TITLE> と </TITLE> で囲まれた文が， HTML文書のタイトル（表題）である事を示す．タイトルは，ブラウザのタイトルバーに表示される．

<BODY> ... </BODY>
    <BODY> と </BODY> で囲まれた内容が，HTML文書の本文である事を示す．

<H2> ... </H2> （<H3> ... </H3>）
    <H2> と </H2> で囲まれた文が見出しである事を示す． H の次の数字は見出しのレベルであり，レベルに応じて文字のサイズや，アンダーラインの有無などが異なる．

<A HREF="リンク先" > ... </A>
    <A HREF="リンク先" > と </A> に囲まれた内容に対して，"リンク先" へリンクを張る． 同一の HTML文書内の特定の位置にリンクを張る場合は， <A NAME="キーワード"> ... </A>を用いて当該位置にアンカーを作成し，「#キーワード」を「リンク先」として指定する．

<A NAME="キーワード" > ... </A>
    <A NAME="キーワード" > と </A> に囲まれた内容が， <A HREF="#キーワード">...</A> で参照されるリンク先（アンカー）である事を示す．

<PRE> ... </PRE>
    <PRE> と </PRE>で囲まれた内容のホワイトスペース（スペース，タブ，改行）を保存する．その他の場所のホワイトスペースは無視される．

<BR>
    改行を指定する．

［課題 II］

以下に示すディレクトリに，FIFAワールドカップ2014の 1次リーグにおけるグループごとの対戦結果を記述したファイルがある．

/home/exp/exppub/exp-material/PC2016/Report1-files

各ファイルにはプレーンテキストの表形式で対戦結果が記述してあり，対戦結果の内容は勝敗を表す記号，および試合結果（得点）である．ただし，各対戦結果は表の第1列にある国を基準としており，勝敗を表す記号は以下の通りである．

    W： 第1列にある国の勝ち
    L： 第1列にある国の負け
    D： 引き分け

また，表中の - は同一国の対戦を意味し，得点は「"第1列にある国の得点"-"第1行にある国の得点"」という形式となっている．たとえば，以下のような内容をもつ group-A というファイル中の対戦結果表において， 2行・5列目の対戦結果は，Cameroon が　Brazil に 1対4 で負けたことを表している．

2014 FIFA World Cup Stage1 Result

Group A
           Brazil Mexico Croatia Cameroon
Brazil         -   D 0-0   W 3-1  W 4-1
Mexico      D 0-0     -    W 3-1  W 1-0
Croatia     L 1-3  L 1-3     -    W 4-0
Cameroon    L 1-4  L 0-1   L 0-4    -

これらのファイルから 対戦結果表の LaTeXファイルを生成する Perlスクリプトreport1table.pl を作成せよ．作成するスクリプトは以下の仕様を満たすこと．

    スクリプトの引数は，グループを表す A ～ H までのアルファベットとする．
    引数は 0個以上，8個まで指定でき，指定された順序で各グループに対する対戦結果表を出力する 1つの LaTeXファイルを生成する．
    引数が省略された場合は，すべてのグループの対戦結果表を A ～ H の順に出力する 1つの LaTeXファイルを生成する．
    不正な引数が指定された場合は，エラーメッセージを出力して終了する．
    生成される LaTeX ファイルの名前は，「group-グループ名.tex」とする．ただし，「グループ名」は出力したグループを表すアルファベットの列とし，その順序は対戦結果表の出力順序と同一とする．

たとえば，グループ A，C，H を指定した場合のファイル名は，group-ACH.tex となる．

また，出力する対戦結果表の形式は，以下の仕様を満たすこと．

    対戦結果表は A4用紙 1ページにつき 1つ出力する．
    表はセンタリングする．
    対戦結果表の上にはグループ名を含むタイトルを表示する．
    対戦結果表は5行7列の罫線付きの表で出力する．
    同一国の対戦結果を表す欄は空欄とする．
    対戦結果には勝敗を表す記号○（勝ち），×（負け），△（引き分け），点数を2行分を用いて出力する．（1行目に勝敗，2行目に点数）
    表の第6列，第7列，第8列は，それぞれ各国の勝ち試合数，引き分け試合数，負け試合数を出力する．
    対戦結果表の第1，6，7, 8列目は上下中央揃えとする．

対戦結果表の形式のサンプルとして PDFファイル group-H.pdf(548)を用意した．参考にせよ．(サンプルはFIFAワールドカップ2010のHグループの結果である．)

尚，余力のあるものは以下の拡張を行え．これら以外にも自由に拡張して構わないが，その場合は拡張した点に関してレポートに仕様を明確に記述すること．

    国名を英語で出力するか日本語で出力するかを指定できるようにする．
    9列目に勝ち点を表示する．
    LaTeX ファイル作成後，ユーザに xdvi によるプレビューを参照したいかどうかを尋ね，必要であれば，LaTeX ファイルをコンパイルし，xdvi を起動する．
    使用するフォントのサイズ，種類を指定できるようにする．

補足事項 -- プログラムの引数 --

Perl スクリプトに対する引数は，特殊変数 @ARGV に格納される．すなわち，$ARGV[0] が一つ目の引数，$ARGV[1] が二つ目の引数等となる．
［課題 III］

Perl/Tk を利用した非常にシンプルなプログラムとして，入力したテキストを指定したファイル名でファイルに書き出すだけのエディタを考える． このエディタは，以下に示す部品から構成される．概観図を下に示す．

    Filename エントリ ：テキストを書き出すファイルの名前を指定するエントリ
    Save ボタン ：テキストの書き出しを行なうボタン
    Clear ボタン ：それまでに入力したテキストを全て削除するボタン
    Quit ボタン ：エディタを終了するボタン
    テキストフィールド：テキストを入力するフィールド

このようなエディタを実現するプログラムとして以下に示すものを作成した．

#!/usr/local/bin/perl
#
# Very Simple Editor
#

use Tk;

$mw = MainWindow->new();
$mw->title("Very Simple Editor");

#
# ボタンとファイル名エントリを格納するフレームを作成
#
$top = $mw->Frame(-borderwidth => 10);
$top->pack(-side => 'top', -fill => 'x');

#
# ボタンとファイル名エントリを作成, 配置
#
$quit = $top->Button(-text => 'Quit', -command => sub { exit });
$clear = $top->Button(-text => 'Clear', -command => \&clear_text);
$save = $top->Button(-text => 'Save', -command => \&save_text);
$label = $top->Label(-text => 'Filename:', -padx => 0);
$filename = $top->Entry(-width => 20,
                        -relief => 'sunken',
                        -textvariable => \$savefilename);
$label->pack(-side => 'left');
$filename->pack(-side => 'left');
$quit->pack(-side => 'right');
$clear->pack(-side => 'right');
$save->pack(-side => 'right');

#
# エディットに利用するテキストウィジェットを作成
#
$textframe = $mw->Frame();
$scroll = $textframe->Scrollbar();
$textfield = $textframe->Text(-width => 80,
                              -height => 25,
                              -borderwidth => 2,
                              -relief => 'sunken',
                              -setgrid => 1,
                              -yscrollcommand => ['set' => $scroll]);
$scroll->configure(-command => ['yview' => $textfield]);
$scroll->pack(-side => 'right', -fill => 'y');
$textfield->pack(-side => 'left', -fill => 'both', -expand => 1);
$textframe->pack(-side => 'top', -fill => 'both', -expand => 1);

#
# 表示
#
MainLoop;

#
# Clearボタンに対応する手続き
# エディット中のテキストをすべて削除する
#
sub clear_text {
    $textfield->delete('1.0','end');
}

#
# Saveボタンに対応する手続き
# filenameエントリに記述されたファイル名でファイルをオープンし,
# テキストウィジェットの内容をそのファイルへ書き込む
#
sub save_text {
    open(OUTFILE, ">$savefilename")
        or warn("Can't open '$savefilename'"), return;
    print OUTFILE $textfield->get('1.0','end');
    close(OUTFILE);
}

このプログラムに関して以下の作業を行ないレポートを作成せよ．

    プログラム中の各命令が何を行なっているかを説明せよ．
    このプログラムを拡張して，以下の機能を追加せよ．
        ファイル名に指定されたファイルからテキストを読み込む Load 機能．
        現在のカーソル位置にファイル名に指定されたファイルからテキストを挿入する Insert 機能．

尚，余力のあるものは，テキスト中から指定した文字列を捜し出す検索機能をつけるなどプログラムの機能拡張を行え．その際には，どのような機能を追加したかをレポートにて説明せよ．拡張する機能としては，たとえば以下のようなものが考えられる．

    文字列の検索
    ファイル選択ダイアログ
    ファイル関係の機能のメニュー化

＜補足事項 -- プログラムのソースコード --＞

プログラムのソースをこのリンクeditor.pl(276)に準備した．各自これをファイルとして保存し，実行属性を付加して実行してみよ．実行属性を付加するには，例えば，editor.pl というファイルの場合，次に示すようにchmod コマンドを用いる．

exp101[1] % chmod u+x editor.pl

＜補足事項 -- カーソル位置の取得 --＞

Perl/Tk では，テキストウィジェット（テキストフィールド）中の入力カーソルの現在位置を， insert というインデックスによって得ることができる．詳細な内容は，テキストウィジェットに関するオンラインマニュアル中の THE INSERTION CURSOR の項目を参照するように．
［提出物］
紙媒体レポート

レポートは，レポート作成上の注意に従い LaTeX で作成し，紙媒体(ハードコピー)を提出せよ．また，レポートには以下の内容を忘れずに含めること．

1) 課題 I

    課題内容
    1），2）の作業がもつ意味
    このシェルスクリプトのコマンドとしての動作説明
    各行の動作内容の説明

2) 課題 II

    課題内容
    仕様
    処理概要
    アルゴリズム
    工夫点
    テスト結果
    対戦結果表の出力(付録として添付，出力するグループ名については，以下の「提出する対戦結果表について」を参照)
    Perl のプログラムリスト(付録として添付)

3) 課題 III

    課題内容
    仕様
    処理概要
    アルゴリズム
    工夫点
    テスト結果
    スクリプトの説明(スクリプト中の各命令が何を行なっているかの説明)
    Perl/Tk のプログラムリスト(付録として添付)

4) 全体

    感想

尚，付録として添付するものについては，いずれも，レポートのページ数制限には含めない．
電子ファイル

以下のディレクトリ配下に各自のユーザ名を名前とするディレクトリが作成してある．

/home/exp/exppub/exp-material/PC2016/Report1

その直下に以下のファイル名の電子ファイルを提出すること．

    groupA ～ groupH: 課題 II の 入力ファイル
    group-?.tex: 課題 II の対戦結果表のLaTeXファイル (出力するグループ名 ? については，以下の「提出する対戦結果表について」を参照)
    group-?.pdf: 課題 II の対戦結果表のPDFファイル
    report1table.pl: 課題 II の Perl プログラム
    report1editor.pl: 課題 III の Perl/Tk プログラム
    report1.tex: レポートの LaTeXソースファイル
    report1.pdf: レポートの PDFファイル

これらも評価の対象となるので，置き忘れないように．

ファイルを指定ディレクトリに置く際にパーミッションに注意すること．パーミッションが正しく設定されていないため，教員，TAがファイルの中身を見ることができない，実行ファイルを実行できない，といった場合にはファイルが提出されていないものとみなす． また，演習室の環境で動作しないプログラムを提出した場合も同様に，ファイルが提出されていないものとみなすので，必ず演習室での動作確認を行うこと．これらに関しては基本的に個別に対応はしませんので，必ず自分で確認してください．
＜提出する対戦結果表について＞

出力する対戦結果表は，各自の学籍番号の下 1桁に3を足して8で割った余りの数字 n に対して，A から n 番目にあるアルファベットにより指定されるグループのものを出力するものとする．たとえば，n が 0 のときはグループ A，n が 6 の場合はグループ G の対戦結果表を提出することになる．
［提出先］

計算機・ソフトウェア事務室（G402）
［提出期限］

    編入生: 2016年8月4日（木）16:30
    その他の受講生: 2016年6月9日（木） 16:30